import{p as e,a as l,B as a,i as t,r as o,o as n,c as s,f as i,F as r,l as d,G as u,t as p,g as c,w as m,b,D as y,h as g,L as k,E as f}from"./vendor.783501fb.js";import{f as v}from"./index.cc8f9e19.js";const h={name:"basetable",props:{cols:{type:Array,required:!0},url:{type:String},needOperation:{type:Boolean,default:!0},noBorder:{type:Boolean,default:!1}},setup(e,l){const o=a({address:"",name:"",pageIndex:1,pageSize:10}),n=t([]),s=t(0),i=()=>{v(o).then((l=>{e.url?n.value=l[e.url.slice(1)]:n.value=l.list,s.value=l.pageTotal||50}))};i();const r=t(!1);let d=a({name:"",address:""});return{query:o,tableData:n,pageTotal:s,editVisible:r,form:d,handleSearch:()=>{o.pageIndex=1,i()},handlePageChange:e=>{o.pageIndex=e,i()},handleDelete:e=>{ElMessageBox.confirm("确定要删除吗？","提示",{type:"warning"}).then((()=>{ElMessage.success("删除成功"),n.value.splice(e,1)})).catch((()=>{}))},handleEdit:e=>{l.emit("edit",e)}}}},D=m();e("data-v-41a3290c");const I={key:1},V={class:"pagination"};l();const C=D(((e,l,a,t,m,b)=>{const y=o("el-table-column"),g=o("el-table"),k=o("el-pagination");return n(),s("div",null,[i(g,{data:t.tableData,border:!a.noBorder,class:"table",ref:"multipleTable","header-cell-class-name":"table-header"},{default:D((()=>[(n(!0),s(r,null,d(a.cols,(l=>(n(),s(y,{key:l.prop,prop:l.prop,label:l.label},{default:D((a=>[l.slot?u(e.$slots,l.slot,{key:0,scopeData:a.row},void 0,!0):(n(),s("span",I,p(a.row[l.prop]),1))])),_:2},1032,["prop","label"])))),128)),a.needOperation?(n(),s(y,{key:0,label:"操作",width:"140"},{default:D((l=>[u(e.$slots,"operation",{scopeData:l.row},void 0,!0)])),_:1})):c("",!0)])),_:1},8,["data","border"]),i("div",V,[i(k,{background:"",layout:"total, prev, pager, next","current-page":t.query.pageIndex,"page-size":t.query.pageSize,total:t.pageTotal,onCurrentChange:t.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"])])])}));h.render=C,h.__scopeId="data-v-41a3290c";const _={components:{},props:{visible:{type:Boolean,required:!0},formItems:{type:Array,required:!0},itemData:{type:Object},propTitle:{type:String}},emits:["close","dialog-submit"],name:"product-add",setup(e,{emit:l}){const o=a({}),n=b((()=>(console.log(e.visible),e.visible))),s=t("编辑");y(n,(()=>{1==n.value?(console.log(e.itemData),e.itemData?(Object.keys(e.itemData).map((l=>{o[l]=e.itemData[l]})),s.value="编辑"):s.value="添加"):Object.keys(o).map((e=>{delete o[e]}))}));return{title:s,close:()=>{l("close")},saveEdit:()=>{l("dialog-submit",o)},form:o}}},x=m();e("data-v-2948e909");const q={class:"dialog-footer"},w=g("关 闭"),S=g("确 定");l();const T=x(((e,l,a,t,u,p)=>{const c=o("el-date-picker"),m=o("el-option"),b=o("el-select"),y=o("el-input"),g=o("el-form-item"),k=o("el-form"),f=o("el-button"),v=o("el-dialog");return n(),s(v,{title:a.propTitle||t.title,modelValue:a.visible,"onUpdate:modelValue":l[1]||(l[1]=e=>a.visible=e),"destroy-on-close":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,"append-to-body":!0,width:"60%"},{footer:x((()=>[i("span",q,[i(f,{onClick:t.close},{default:x((()=>[w])),_:1},8,["onClick"]),i(f,{type:"primary",onClick:t.saveEdit},{default:x((()=>[S])),_:1},8,["onClick"])])])),default:x((()=>[i(k,{"label-width":"170px",inline:""},{default:x((()=>[(n(!0),s(r,null,d(a.formItems,(e=>(n(),s(g,{style:e.width?`width:${e.width}`:"width: 48%",key:e.key,label:e.label,required:!1!==e.required},{default:x((()=>["date"==e.type?(n(),s(c,{key:0,modelValue:t.form[e.key],"onUpdate:modelValue":l=>t.form[e.key]=l,type:"date",style:{width:"100%"},placeholder:"选择日期"},null,8,["modelValue","onUpdate:modelValue"])):"select"==e.type?(n(),s(b,{key:1,modelValue:t.form[e.key],"onUpdate:modelValue":l=>t.form[e.key]=l,type:"date",style:{width:"100%"}},{default:x((()=>[(n(!0),s(r,null,d(e.options,(e=>(n(),s(m,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])):(n(),s(y,{key:2,modelValue:t.form[e.key],"onUpdate:modelValue":l=>t.form[e.key]=l,type:e.type||"text",placeholder:e.placeholder},null,8,["modelValue","onUpdate:modelValue","type","placeholder"]))])),_:2},1032,["style","label","required"])))),128))])),_:1})])),_:1},8,["title","modelValue"])}));_.render=T,_.__scopeId="data-v-2948e909";const L={components:{BaseTable:h,ProductAdd:_},props:{taskIndex:{type:String},query:{type:Object}},name:"product-manage",setup(e){const l=a({address:"",name:"",pageIndex:1,pageSize:10}),o=t([]),n=t(0),s=()=>{v(l).then((e=>{o.value=e.list,n.value=e.pageTotal||50}))},i=t(!1);let r=t(null);const d=t(!1),u=t(!1),p=t(!1),c=t(!1),m=t(null);return{columns:[{label:"量具名称",prop:"mesuringName"},{label:"量具规格",prop:"mesuringSpecs"},{label:"量具编号",prop:"mesuringId"},{label:"归属序号",prop:"fromIndex"},{label:"数量",prop:"num"},{label:"状态",prop:"status"},{label:"入库时间",prop:"inTime"},{label:"归还时间",prop:"returnTime"}],formItems:[{label:"量具名称",key:"mesuringName",required:!0},{label:"量具规格",key:"mesuringSpecs",required:!0},{label:"量具编号",key:"mesuringId",required:!0},{label:"归属序号",key:"fromIndex",required:!0,type:"select",options:[{label:"21-9-1",value:"21-9-1"}]},{label:"数量",type:"number",key:"num",required:!0},{label:"状态",key:"status",required:!0,type:"select",options:[{label:"在使用",value:"在使用"},{label:"已归还",value:"已归还"}]},{label:"入库时间",key:"inTime",type:"date",required:!0},{label:"归还时间",key:"returnTime",type:"date",required:!0}],query:l,tableData:o,pageTotal:n,editVisible:i,handleSearch:()=>{l.pageIndex=1,s()},handlePageChange:e=>{l.pageIndex=e,s()},handleDelete:e=>{k.confirm("确定要删除吗？","提示",{type:"warning"}).then((()=>{f.success("删除成功"),o.value.splice(e,1)})).catch((()=>{}))},handleEdit:e=>{i.value=!0,r.value=e},showDetail:e=>{r.value=e,d.value=!0},editItemData:r,editSubmit:e=>{console.log(e)},handleAdd:()=>{console.log(111),i.value=!0,r.value=null},detailVisible:d,handleLendingRecords:e=>{u.value=!0,r.value=e},lendingRecordsColumns:[{label:"领用人",prop:"lendUser"},{label:"领用日期",prop:"lendTime"},{label:"还回日期",prop:"returnTime"},{label:"备注",prop:"remark"}],lendingRecordsVisible:u,showAddLend:e=>{p.value=!0},addLendVisible:p,addLendFormItems:[{label:"领用人",key:"lendUser",required:!0},{label:"领用数量",key:"num",required:!0,type:"number"},{label:"备注",key:"remark",required:!0,type:"textarea"}],addLendSubmit:e=>{console.log(e)},showReturnMesuring:e=>{c.value=!0,m.value=e},returnMesuringVisible:c,returnMesuringItems:[{label:"归还数量",key:"num",required:!0,type:"number"}],returnMesuringSubmit:e=>{console.log(e)}}}},E=m();e("data-v-20b9921b");const M=g("领用记录 "),R=g("编辑 "),U=g("删除"),B=g(" 领用 "),j=g("归还 "),A=g("删除"),O={class:"dialog-footer"},z=g("关 闭");l();const P=E(((e,l,a,t,r,d)=>{const u=o("el-tag"),m=o("el-link"),b=o("el-button"),y=o("BaseTable"),k=o("el-dialog"),f=o("ProductAdd");return n(),s("div",null,[i(y,{cols:t.columns,url:"/mesuring",onEdit:t.handleEdit},{status:E((e=>[i(u,{type:"成功"===e.scopeData.status?"success":"失败"===e.scopeData.status?"danger":""},{default:E((()=>[g(p(e.scopeData.status),1)])),_:2},1032,["type"])])),taskId:E((e=>[i(m,{href:"javascript:void(0)",type:"primary",onClick:l=>t.showDetail(e.scopeData)},{default:E((()=>[g(p(e.scopeData.taskId),1)])),_:2},1032,["onClick"])])),operation:E((e=>[i(b,{type:"text",icon:"el-icon-document",class:"color-success",onClick:l=>t.handleLendingRecords(e.scopeData)},{default:E((()=>[M])),_:2},1032,["onClick"]),a.taskIndex?c("",!0):(n(),s(b,{key:0,type:"text",icon:"el-icon-edit",style:{"margin-left":"0"},onClick:l=>t.handleEdit(e.scopeData)},{default:E((()=>[R])),_:2},1032,["onClick"])),a.taskIndex?c("",!0):(n(),s(b,{key:1,type:"text",icon:"el-icon-delete",class:"color-danger",onClick:l=>t.handleDelete(e.scopeData)},{default:E((()=>[U])),_:2},1032,["onClick"]))])),_:1},8,["cols","onEdit"]),i(k,{title:`领用记录 - ${t.editItemData&&t.editItemData.mesuringId}`,modelValue:t.lendingRecordsVisible,"onUpdate:modelValue":l[2]||(l[2]=e=>t.lendingRecordsVisible=e),"close-on-click-modal":!1,"close-on-press-escape":!1,width:"60%"},{footer:E((()=>[i("span",O,[i(b,{onClick:l[1]||(l[1]=e=>t.lendingRecordsVisible=!1)},{default:E((()=>[z])),_:1})])])),default:E((()=>[i(b,{type:"primary",icon:"el-icon-plus",style:{"margin-bottom":"20px"},onClick:t.showAddLend},{default:E((()=>[B])),_:1},8,["onClick"]),i(y,{cols:t.lendingRecordsColumns,url:"/lendRecords"},{operation:E((e=>[e.scopeData.returnTime?c("",!0):(n(),s(b,{key:0,type:"text",icon:"el-icon-download",class:"color-success",onClick:l=>t.showReturnMesuring(e.scopeData)},{default:E((()=>[j])),_:2},1032,["onClick"])),i(b,{type:"text",icon:"el-icon-delete",class:"color-danger",onClick:l=>t.handleDelete(e.scopeData)},{default:E((()=>[A])),_:2},1032,["onClick"])])),_:1},8,["cols"])])),_:1},8,["title","modelValue"]),i(f,{visible:t.editVisible,onClose:l[3]||(l[3]=e=>t.editVisible=!1),itemData:t.editItemData,formItems:t.formItems,key:"product-edit",onDialogSubmit:t.editSubmit},null,8,["visible","itemData","formItems","onDialogSubmit"]),i(f,{visible:t.addLendVisible,onClose:l[4]||(l[4]=e=>t.addLendVisible=!1),formItems:t.addLendFormItems,propTitle:"领用量具",onDialogSubmit:t.addLendSubmit},null,8,["visible","formItems","onDialogSubmit"]),i(f,{visible:t.returnMesuringVisible,onClose:l[5]||(l[5]=e=>t.returnMesuringVisible=!1),formItems:t.returnMesuringItems,propTitle:"归还量具",onDialogSubmit:t.returnMesuringSubmit},null,8,["visible","formItems","onDialogSubmit"])])}));L.render=P,L.__scopeId="data-v-20b9921b";export{h as _,L as a,_ as b};
