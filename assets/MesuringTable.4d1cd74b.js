import{p as e,a as l,B as a,i as t,r as o,o as n,c as s,f as i,F as r,l as d,G as u,t as p,g as c,w as m,h as b,b as g,D as y,L as h,E as f}from"./vendor.783501fb.js";import{f as k}from"./index.4c0ae215.js";const v={name:"basetable",props:{cols:{type:Array,required:!0},url:{type:String},needOperation:{type:Boolean,default:!0},noBorder:{type:Boolean,default:!1},noPager:{type:Boolean,default:!1}},setup(e,l){const o=a({address:"",name:"",pageIndex:1,pageSize:10}),n=t([]),s=t(0),i=()=>{k(o).then((l=>{e.url?n.value=l[e.url.slice(1)]:n.value=l.list,s.value=l.pageTotal||50}))};i();const r=t(!1);let d=a({name:"",address:""});return{query:o,tableData:n,pageTotal:s,editVisible:r,form:d,handleSearch:()=>{o.pageIndex=1,i()},handlePageChange:e=>{o.pageIndex=e,i()},handleDelete:e=>{ElMessageBox.confirm("确定要删除吗？","提示",{type:"warning"}).then((()=>{ElMessage.success("删除成功"),n.value.splice(e,1)})).catch((()=>{}))},handleEdit:e=>{l.emit("edit",e)}}}},D=m();e("data-v-3ccf0ae9");const I=b(" 导出表格"),C=i("i",{class:"el-icon-arrow-down el-icon--right"},null,-1),w=b("导出当页"),V=b("导出全部"),_={key:1},x={key:0,class:"pagination"};l();const S=D(((e,l,a,t,m,b)=>{const g=o("el-button"),y=o("el-dropdown-item"),h=o("el-dropdown-menu"),f=o("el-dropdown"),k=o("el-table-column"),v=o("el-table"),S=o("el-pagination");return n(),s("div",null,[i(f,{style:{float:"right","margin-bottom":"10px"}},{dropdown:D((()=>[i(h,null,{default:D((()=>[i(y,null,{default:D((()=>[w])),_:1}),i(y,null,{default:D((()=>[V])),_:1})])),_:1})])),default:D((()=>[i(g,{type:"primary",size:"small"},{default:D((()=>[I,C])),_:1})])),_:1}),i(v,{data:t.tableData,border:!a.noBorder,class:"table",ref:"multipleTable","header-cell-class-name":"table-header"},{default:D((()=>[(n(!0),s(r,null,d(a.cols,(l=>(n(),s(k,{key:l.prop,prop:l.prop,label:l.label},{default:D((a=>[l.slot?u(e.$slots,l.slot,{key:0,scopeData:a.row},void 0,!0):(n(),s("span",_,p(a.row[l.prop]),1))])),_:2},1032,["prop","label"])))),128)),a.needOperation?(n(),s(k,{key:0,label:"操作",width:"140"},{default:D((l=>[u(e.$slots,"operation",{scopeData:l.row},void 0,!0)])),_:1})):c("",!0)])),_:1},8,["data","border"]),a.noPager?c("",!0):(n(),s("div",x,[i(S,{background:"",layout:"total, prev, pager, next","current-page":t.query.pageIndex,"page-size":t.query.pageSize,total:t.pageTotal,onCurrentChange:t.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"])]))])}));v.render=S,v.__scopeId="data-v-3ccf0ae9";const q={name:"user-select",props:{userData:{type:Object,required:!0}},setup(e,{emit:l}){const a=t(!1),o=t([]),n=t([]);n.value=["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"].map((e=>({value:`value:${e}`,label:`label:${e}`})));return{onSelectChange:e=>{console.log(e),l("update:userData",e)},remoteMethod:e=>{""!==e?(a.value=!0,setTimeout((()=>{console.log(e),a.value=!1,o.value=n.value.filter((l=>l.label.toLowerCase().indexOf(e.toLowerCase())>-1))}),200)):o.value=[]},options:o,list:n,loading:a}}},M=m(),T=M(((e,l,a,t,u,p)=>{const c=o("el-option"),m=o("el-select");return n(),s("div",null,[i(m,{modelValue:a.userData,"onUpdate:modelValue":l[1]||(l[1]=e=>a.userData=e),filterable:"",remote:"",placeholder:"请输入关键词","remote-method":t.remoteMethod,onChange:t.onSelectChange,loading:t.loading},{default:M((()=>[(n(!0),s(r,null,d(t.options,(e=>(n(),s(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","remote-method","onChange","loading"])])}));q.render=T,q.__scopeId="data-v-223bf5e5";const U={components:{UserSelect:q},props:{visible:{type:Boolean,required:!0},formItems:{type:Array,required:!0},itemData:{type:Object},propTitle:{type:String}},emits:["close","dialog-submit"],name:"product-add",setup(e,{emit:l}){const o=a({}),n=g((()=>e.visible)),s=t("编辑");y(n,(()=>{1==n.value?e.itemData?(Object.keys(e.itemData).map((l=>{o[l]=e.itemData[l]})),s.value="编辑"):s.value="添加":Object.keys(o).map((e=>{delete o[e]}))}));const i=t();return{title:s,close:()=>{l("close")},saveEdit:async()=>{i.value.validate((e=>{console.log(e)})),l("dialog-submit",o)},form:o,ruleForm:i}}},L=m();e("data-v-0be75afe");const R={class:"dialog-footer"},A=b("关 闭"),E=b("确 定");l();const O=L(((e,l,a,t,u,p)=>{const c=o("el-date-picker"),m=o("el-option"),b=o("el-select"),g=o("UserSelect"),y=o("el-input"),h=o("el-form-item"),f=o("el-form"),k=o("el-button"),v=o("el-dialog");return n(),s(v,{title:a.propTitle||t.title,modelValue:a.visible,"onUpdate:modelValue":l[1]||(l[1]=e=>a.visible=e),"destroy-on-close":!0,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,"append-to-body":!0,width:"60%"},{footer:L((()=>[i("span",R,[i(k,{onClick:t.close},{default:L((()=>[A])),_:1},8,["onClick"]),i(k,{type:"primary",onClick:t.saveEdit},{default:L((()=>[E])),_:1},8,["onClick"])])])),default:L((()=>[i(f,{"label-width":"170px",ref:"ruleForm",model:t.form,inline:""},{default:L((()=>[(n(!0),s(r,null,d(a.formItems,(e=>(n(),s(h,{style:e.width?`width:${e.width}`:"width: 48%",key:e.key,label:e.label,rules:[{required:!1!==e.required,message:`请填写${e.label}`}],required:!1!==e.required},{default:L((()=>["date"==e.type?(n(),s(c,{key:0,modelValue:t.form[e.key],"onUpdate:modelValue":l=>t.form[e.key]=l,type:"date",disabled:e.disabled,style:{width:"100%"},placeholder:"选择日期"},null,8,["modelValue","onUpdate:modelValue","disabled"])):"select"==e.type?(n(),s(b,{key:1,modelValue:t.form[e.key],"onUpdate:modelValue":l=>t.form[e.key]=l,type:"date",disabled:e.disabled,style:{width:"100%"}},{default:L((()=>[(n(!0),s(r,null,d(e.options,(e=>(n(),s(m,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])):"user"==e.type?(n(),s(g,{key:2,userData:t.form[e.key],"onUpdate:userData":l=>t.form[e.key]=l,style:{width:"100%"}},null,8,["userData","onUpdate:userData"])):(n(),s(y,{key:3,modelValue:t.form[e.key],"onUpdate:modelValue":l=>t.form[e.key]=l,disabled:e.disabled,type:e.type||"text",placeholder:e.placeholder},null,8,["modelValue","onUpdate:modelValue","disabled","type","placeholder"]))])),_:2},1032,["style","label","rules","required"])))),128))])),_:1},8,["model"])])),_:1},8,["title","modelValue"])}));U.render=O,U.__scopeId="data-v-0be75afe";const B={components:{BaseTable:v,ProductAdd:U},props:{taskIndex:{type:String},query:{type:Object}},name:"product-manage",setup(e){const l=a({address:"",name:"",pageIndex:1,pageSize:10}),o=t([]),n=t(0),s=()=>{k(l).then((e=>{o.value=e.list,n.value=e.pageTotal||50}))},i=t(!1);let r=t(null);const d=t(!1),u=t(!1),p=t(!1),c=t(!1),m=t(null);return{columns:[{label:"量具名称",prop:"mesuringName"},{label:"量具规格",prop:"mesuringSpecs"},{label:"量具编号",prop:"mesuringId"},{label:"归属序号",prop:"fromIndex"},{label:"数量",prop:"num"},{label:"状态",prop:"status"},{label:"入库时间",prop:"inTime"},{label:"归还时间",prop:"returnTime"}],formItems:[{label:"量具名称",key:"mesuringName",required:!0},{label:"量具规格",key:"mesuringSpecs",required:!0},{label:"量具编号",key:"mesuringId",required:!0},{label:"归属序号",key:"fromIndex",required:!0,type:"select",options:[{label:"21-9-1",value:"21-9-1"}]},{label:"数量",type:"number",key:"num",required:!0},{label:"状态",key:"status",required:!0,type:"select",options:[{label:"在使用",value:"在使用"},{label:"已归还",value:"已归还"}]},{label:"入库时间",key:"inTime",type:"date",required:!0},{label:"归还时间",key:"returnTime",type:"date",required:!0}],query:l,tableData:o,pageTotal:n,editVisible:i,handleSearch:()=>{l.pageIndex=1,s()},handlePageChange:e=>{l.pageIndex=e,s()},handleDelete:e=>{h.confirm("确定要删除吗？","提示",{type:"warning"}).then((()=>{f.success("删除成功"),o.value.splice(e,1)})).catch((()=>{}))},handleEdit:e=>{i.value=!0,r.value=e},showDetail:e=>{r.value=e,d.value=!0},editItemData:r,editSubmit:e=>{console.log(e)},handleAdd:()=>{console.log(111),i.value=!0,r.value=null},detailVisible:d,handleLendingRecords:e=>{u.value=!0,r.value=e},lendingRecordsColumns:[{label:"领用人",prop:"lendUser"},{label:"领用日期",prop:"lendTime"},{label:"还回日期",prop:"returnTime"},{label:"备注",prop:"remark"}],lendingRecordsVisible:u,showAddLend:e=>{p.value=!0},addLendVisible:p,addLendFormItems:[{label:"领用人",key:"lendUser",required:!0},{label:"领用数量",key:"num",required:!0,type:"number"},{label:"备注",key:"remark",required:!0,type:"textarea"}],addLendSubmit:e=>{console.log(e)},showReturnMesuring:e=>{c.value=!0,m.value=e},returnMesuringVisible:c,returnMesuringItems:[{label:"归还数量",key:"num",required:!0,type:"number"}],returnMesuringSubmit:e=>{console.log(e)}}}},N=m();e("data-v-20b9921b");const j=b("领用记录 "),P=b("编辑 "),z=b("删除"),$=b(" 领用 "),F=b("归还 "),W=b("删除"),G={class:"dialog-footer"},H=b("关 闭");l();const K=N(((e,l,a,t,r,d)=>{const u=o("el-tag"),m=o("el-link"),g=o("el-button"),y=o("BaseTable"),h=o("el-dialog"),f=o("ProductAdd");return n(),s("div",null,[i(y,{cols:t.columns,url:"/mesuring",onEdit:t.handleEdit},{status:N((e=>[i(u,{type:"成功"===e.scopeData.status?"success":"失败"===e.scopeData.status?"danger":""},{default:N((()=>[b(p(e.scopeData.status),1)])),_:2},1032,["type"])])),taskId:N((e=>[i(m,{href:"javascript:void(0)",type:"primary",onClick:l=>t.showDetail(e.scopeData)},{default:N((()=>[b(p(e.scopeData.taskId),1)])),_:2},1032,["onClick"])])),operation:N((e=>[i(g,{type:"text",icon:"el-icon-document",class:"color-success",onClick:l=>t.handleLendingRecords(e.scopeData)},{default:N((()=>[j])),_:2},1032,["onClick"]),a.taskIndex?c("",!0):(n(),s(g,{key:0,type:"text",icon:"el-icon-edit",style:{"margin-left":"0"},onClick:l=>t.handleEdit(e.scopeData)},{default:N((()=>[P])),_:2},1032,["onClick"])),a.taskIndex?c("",!0):(n(),s(g,{key:1,type:"text",icon:"el-icon-delete",class:"color-danger",onClick:l=>t.handleDelete(e.scopeData)},{default:N((()=>[z])),_:2},1032,["onClick"]))])),_:1},8,["cols","onEdit"]),i(h,{title:`领用记录 - ${t.editItemData&&t.editItemData.mesuringId}`,modelValue:t.lendingRecordsVisible,"onUpdate:modelValue":l[2]||(l[2]=e=>t.lendingRecordsVisible=e),"close-on-click-modal":!1,"close-on-press-escape":!1,width:"60%"},{footer:N((()=>[i("span",G,[i(g,{onClick:l[1]||(l[1]=e=>t.lendingRecordsVisible=!1)},{default:N((()=>[H])),_:1})])])),default:N((()=>[i(g,{type:"primary",icon:"el-icon-plus",style:{"margin-bottom":"20px"},onClick:t.showAddLend},{default:N((()=>[$])),_:1},8,["onClick"]),i(y,{cols:t.lendingRecordsColumns,url:"/lendRecords"},{operation:N((e=>[e.scopeData.returnTime?c("",!0):(n(),s(g,{key:0,type:"text",icon:"el-icon-download",class:"color-success",onClick:l=>t.showReturnMesuring(e.scopeData)},{default:N((()=>[F])),_:2},1032,["onClick"])),i(g,{type:"text",icon:"el-icon-delete",class:"color-danger",onClick:l=>t.handleDelete(e.scopeData)},{default:N((()=>[W])),_:2},1032,["onClick"])])),_:1},8,["cols"])])),_:1},8,["title","modelValue"]),i(f,{visible:t.editVisible,onClose:l[3]||(l[3]=e=>t.editVisible=!1),itemData:t.editItemData,formItems:t.formItems,key:"product-edit",onDialogSubmit:t.editSubmit},null,8,["visible","itemData","formItems","onDialogSubmit"]),i(f,{visible:t.addLendVisible,onClose:l[4]||(l[4]=e=>t.addLendVisible=!1),formItems:t.addLendFormItems,propTitle:"领用量具",onDialogSubmit:t.addLendSubmit},null,8,["visible","formItems","onDialogSubmit"]),i(f,{visible:t.returnMesuringVisible,onClose:l[5]||(l[5]=e=>t.returnMesuringVisible=!1),formItems:t.returnMesuringItems,propTitle:"归还量具",onDialogSubmit:t.returnMesuringSubmit},null,8,["visible","formItems","onDialogSubmit"])])}));B.render=K,B.__scopeId="data-v-20b9921b";export{v as _,B as a,U as b};
