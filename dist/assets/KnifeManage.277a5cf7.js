var e=Object.defineProperty,l=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,o=(l,a,t)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[a]=t,r=(e,r)=>{for(var i in r||(r={}))a.call(r,i)&&o(e,i,r[i]);if(l)for(var i of l(r))t.call(r,i)&&o(e,i,r[i]);return e};import{i,b as u,p as d,h as n,L as s,w as c,r as p,o as m,c as b,e as y,l as f,t as h,q as v,g}from"./vendor.86c6712b.js";import{_ as k}from"./MesuringTable.63d439f4.js";import{s as D,_ as V,a as C}from"./index.2615daba.js";import{a as I}from"./ProductDetail.382fd02a.js";const _={components:{BaseTable:k,ProductAdd:V,ProductDetail:I,UserSelect:C},name:"product-manage",setup(){const e=i({purchaseUnit:"",name:"",specification:"",pageIndex:1,pageSize:10}),l=u(),a=()=>{l.value.refresh(e)},t=u(!1);let o=u(null);const d=u(!1),n=u(!1),p=u(!1),m=i({user:""}),b=u({}),y=()=>{b.value.refresh(m)},f=u(!1),h=u(!1),v=u(null),g=u(!1),k=i({name:"",specification:""}),V=u({}),C=()=>{V.value.refresh(k)},I=u(!1),_=u(null);return{columns:[{label:"采购单位",prop:"purchaseUnit",slot:"purchaseUnit"},{label:"刀具名称",prop:"name"},{label:"规格型号",prop:"specification",slot:"specification"},{label:"库房存放点",prop:"locations"},{label:"库房剩余数量",prop:"surplus"},{label:"总购数量",prop:"totalBuy"},{label:"归还后可二次使用数量",prop:"returnNums"},{label:"废品数量",prop:"waste"}],formItems:[{label:"采购单位",key:"purchaseUnit"},{label:"刀具名称",key:"name"},{label:"规格型号",key:"specification"},{label:"库房存放点",key:"locations"},{label:"总购数量",key:"totalBuy"},{label:"库房剩余数量",key:"surplus"},{label:"归还后可二次使用数量",key:"returnNums"},{label:"废品数量",key:"waste"}],query:e,cutterTable:l,editVisible:t,handleSearch:a,handleDelete:e=>{s.confirm("确定要删除吗？","提示",{type:"warning"}).then((()=>{c.success("删除成功")})).catch((()=>{}))},handleEdit:e=>{t.value=!0,o.value=e},showDetail:e=>{o.value=e,d.value=!0},editItemData:o,editSubmit:async e=>{var l;await(e=>D({url:"/cutter-manage/save",method:"post",data:e}))(r({id:null==(l=o.value)?void 0:l.id},e)),c.success("添加成功"),t.value=!1,a()},handleAdd:()=>{t.value=!0,o.value=null},detailVisible:d,handleLendingRecords:(e,l)=>{n.value=!0,p.value=l,o.value=e},handleLendRecordDelete:e=>{s.confirm("确定要删除吗？","提示",{type:"warning"}).then((async()=>{await(e=>D({url:`/cutter-manage/claims/remove/${e.recordId}`,method:"delete",data:e}))({recordId:e.id}),c.success("删除成功"),y()})).catch((()=>{}))},lendingRecordsColumns:[{label:"采购单位",prop:"purchaseUnit"},{label:"领用人",prop:"userName"},{label:"领用数量",prop:"useNumber"},{label:"归还数量",prop:"retNum"},{label:"领用日期",prop:"created"},{label:"归还后可二次使用数量",prop:"retUseNum"},{label:"废品数量",prop:"waste"},{label:"还回日期",prop:"retTime"},{label:"归属序号",prop:"serial"},{label:"零件代号",prop:"partCode"},{label:"零件名称",prop:"partName"},{label:"备注",prop:"remark"}],lendingRecordsVisible:n,lendQuery:m,handleLendSearch:y,cutterLendRecordTable:b,showAddLend:e=>{f.value=!0},lendDialogTypeFlag:p,addLendVisible:f,addLendFormItems:[{label:"领用人",key:"user",required:!0,type:"user"},{label:"领用数量",key:"nums",required:!0,type:"number"},{label:"领用类型",key:"useStatus",required:!0,type:"select",options:[{label:"全新",value:"NEW_CUTTER"},{label:"二次使用",value:"OLD_CUTTER"}]},{label:"归属序号",key:"serial",required:!1,placeholder:"用于加工哪个序号"},{label:"备注",key:"remark",required:!1,type:"textarea"}],addLendSubmit:async e=>{var l;await(e=>D({url:"/cutter-manage/claims/add",method:"post",data:e}))(r({cutter:null==(l=o.value)?void 0:l.id},e)),c.success("操作成功"),f.value=!1,y()},showReturnMesuring:e=>{h.value=!0,v.value=e},returnMesuringVisible:h,returnMesuringItems:[{label:"归还数量",key:"retNum",required:!0,type:"number"},{label:"归还后可二次使用数量",key:"availableNum",required:!0,type:"number"},{label:"废品数量",key:"badNum",required:!0,type:"number"}],returnMesuringSubmit:async e=>{var l;await(e=>D({url:"/cutter-manage/claims/ret",method:"put",data:e}))(r({id:null==(l=v.value)?void 0:l.id},e)),c.success("操作成功"),h.value=!1,y()},buyRecordsVisible:g,handBuyRecords:e=>{g.value=!0,o.value=e},buyQuery:k,cutterBuyTable:V,handleBuySearch:C,addBuyVisible:I,showAddBuy:e=>{I.value=!0,o.value=e,_.value=null},addBuySubmit:async e=>{var l;await(e=>D({url:"/cutter-manage/record/addOrModify",method:"post",data:e}))(r({cutters:null==(l=o.value)?void 0:l.id},e)),c.success("操作成功"),I.value=!1,a()},buyRecordsColumns:[{label:"生产厂家",prop:"makeCompany"},{label:"刀具名称",prop:"cutterName"},{label:"规格型号",prop:"specification"},{label:"采购时间",prop:"buyDate"},{label:"采购数量",prop:"nums"},{label:"采购单价",prop:"price"},{label:"回厂时间",prop:"returnDate"}],addBuyFormItems:[{label:"采购时间",key:"buyDate",type:"date",required:!0},{label:"采购数量",key:"nums",required:!0},{label:"采购单价",key:"price",required:!0},{label:"回厂时间",key:"returnDate",type:"date",required:!0}],handleDeleteBuyRecord:e=>{s.confirm("确定要删除吗？删除后库存将减少","提示",{type:"danger"}).then((async()=>{await(e=>D({url:`/cutter-manage/record/remove/${e.recordId}`,method:"delete",data:e}))({recordId:e.id}),c.success("删除成功"),C()})).catch((()=>{}))},showEditBuy:e=>{I.value=!0,_.value=e},editBuyRecordItem:_}}},R=g();d("data-v-0d98efb7");const B={class:"container"},w=f("查询"),S=f("添加刀具"),q=f("领用记录 "),U=f(" 添加购买记录 "),T=f("查询"),L=f(" 领用 "),x=f("归还 "),N=f("删除"),M={class:"dialog-footer"},j=f("关 闭"),Q=f("查询"),A=f("删除"),O={class:"dialog-footer"},$=f("关 闭");n();const E=R(((e,l,a,t,o,r)=>{var i,u,d;const n=p("el-input"),s=p("el-form-item"),c=p("el-button"),g=p("el-form"),k=p("el-link"),D=p("BaseTable"),V=p("ProductAdd"),C=p("UserSelect"),I=p("el-dialog");return m(),b("div",null,[y("div",B,[y(g,{inline:!0,model:t.query,class:"demo-form-inline"},{default:R((()=>[y(s,{label:"采购单位"},{default:R((()=>[y(n,{modelValue:t.query.purchaseUnit,"onUpdate:modelValue":l[1]||(l[1]=e=>t.query.purchaseUnit=e),placeholder:"采购单位"},null,8,["modelValue"])])),_:1}),y(s,{label:"刀具名称"},{default:R((()=>[y(n,{modelValue:t.query.name,"onUpdate:modelValue":l[2]||(l[2]=e=>t.query.name=e),placeholder:"刀具名称"},null,8,["modelValue"])])),_:1}),y(s,{label:"规格型号"},{default:R((()=>[y(n,{modelValue:t.query.specification,"onUpdate:modelValue":l[3]||(l[3]=e=>t.query.specification=e),placeholder:"规格型号"},null,8,["modelValue"])])),_:1}),y(s,null,{default:R((()=>[y(c,{type:"primary",onClick:t.handleSearch},{default:R((()=>[w])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"]),y(c,{type:"primary",icon:"el-icon-plus",style:{"margin-bottom":"20px"},onClick:t.handleAdd},{default:R((()=>[S])),_:1},8,["onClick"]),y(D,{cols:t.columns,needExport:"",ref:"cutterTable",url:"/cutter-manage/pages"},{specification:R((e=>[y(k,{href:"javascript:void(0)",type:"primary",onClick:l=>t.handleLendingRecords(e.scopeData,!0)},{default:R((()=>[f(h(e.scopeData.specification),1)])),_:2},1032,["onClick"])])),purchaseUnit:R((e=>[y(k,{href:"javascript:void(0)",type:"primary",onClick:l=>t.handBuyRecords(e.scopeData)},{default:R((()=>[f(h(e.scopeData.purchaseUnit),1)])),_:2},1032,["onClick"])])),operation:R((e=>[y(c,{type:"text",icon:"el-icon-document",class:"color-success",onClick:l=>t.handleLendingRecords(e.scopeData,!1)},{default:R((()=>[q])),_:2},1032,["onClick"]),y(c,{type:"text",icon:"el-icon-goods",style:{"margin-left":"0"},onClick:l=>t.showAddBuy(e.scopeData)},{default:R((()=>[U])),_:2},1032,["onClick"])])),_:1},8,["cols"])]),y(V,{visible:t.editVisible,onClose:l[4]||(l[4]=e=>t.editVisible=!1),itemData:t.editItemData,formItems:t.formItems,propTitle:"添加刀具",onDialogSubmit:t.editSubmit},null,8,["visible","itemData","formItems","onDialogSubmit"]),y(I,{title:`领用记录 - ${t.editItemData&&t.editItemData.specification}`,modelValue:t.lendingRecordsVisible,"onUpdate:modelValue":l[7]||(l[7]=e=>t.lendingRecordsVisible=e),"destroy-on-close":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"80%"},{footer:R((()=>[y("span",M,[y(c,{onClick:l[6]||(l[6]=e=>t.lendingRecordsVisible=!1)},{default:R((()=>[j])),_:1})])])),default:R((()=>[y(g,{inline:!0,model:t.lendQuery,class:"demo-form-inline"},{default:R((()=>[y(s,{label:"领用人"},{default:R((()=>[y(C,{userData:t.lendQuery.user,"onUpdate:userData":l[5]||(l[5]=e=>t.lendQuery.user=e),style:{width:"200px"}},null,8,["userData"])])),_:1}),y(s,null,{default:R((()=>[y(c,{type:"primary",onClick:t.handleLendSearch},{default:R((()=>[T])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"]),t.lendDialogTypeFlag?v("",!0):(m(),b(c,{key:0,type:"primary",icon:"el-icon-plus",style:{"margin-bottom":"20px"},onClick:t.showAddLend},{default:R((()=>[L])),_:1},8,["onClick"])),y(D,{cols:t.lendingRecordsColumns,ref:"cutterLendRecordTable",url:"/cutter-manage/claims/pages",queryBase:t.lendDialogTypeFlag?{specification:t.editItemData.specification}:{cutters:t.editItemData.id}},{operation:R((e=>[y(c,{type:"text",icon:"el-icon-download",class:"color-success",onClick:l=>t.showReturnMesuring(e.scopeData)},{default:R((()=>[x])),_:2},1032,["onClick"]),y(c,{type:"text",icon:"el-icon-delete",class:"color-danger",onClick:l=>t.handleLendRecordDelete(e.scopeData)},{default:R((()=>[N])),_:2},1032,["onClick"])])),_:1},8,["cols","queryBase"])])),_:1},8,["title","modelValue"]),y(V,{visible:t.addLendVisible,onClose:l[8]||(l[8]=e=>t.addLendVisible=!1),formItems:t.addLendFormItems,propTitle:"领用刀具",onDialogSubmit:t.addLendSubmit},null,8,["visible","formItems","onDialogSubmit"]),y(V,{visible:t.returnMesuringVisible,onClose:l[9]||(l[9]=e=>t.returnMesuringVisible=!1),formItems:t.returnMesuringItems,propTitle:"归还刀具",onDialogSubmit:t.returnMesuringSubmit},null,8,["visible","formItems","onDialogSubmit"]),y(I,{title:`采购记录 - ${t.editItemData&&t.editItemData.purchaseUnit}`,modelValue:t.buyRecordsVisible,"onUpdate:modelValue":l[13]||(l[13]=e=>t.buyRecordsVisible=e),"destroy-on-close":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"80%"},{footer:R((()=>[y("span",O,[y(c,{onClick:l[12]||(l[12]=e=>t.buyRecordsVisible=!1)},{default:R((()=>[$])),_:1})])])),default:R((()=>[y(g,{inline:!0,model:t.buyQuery,class:"demo-form-inline"},{default:R((()=>[y(s,{label:"刀具名称"},{default:R((()=>[y(n,{modelValue:t.buyQuery.name,"onUpdate:modelValue":l[10]||(l[10]=e=>t.buyQuery.name=e),placeholder:"刀具名称"},null,8,["modelValue"])])),_:1}),y(s,{label:"规格型号"},{default:R((()=>[y(n,{modelValue:t.buyQuery.specification,"onUpdate:modelValue":l[11]||(l[11]=e=>t.buyQuery.specification=e),placeholder:"规格型号"},null,8,["modelValue"])])),_:1}),y(s,null,{default:R((()=>[y(c,{type:"primary",onClick:t.handleBuySearch},{default:R((()=>[Q])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"]),y(D,{cols:t.buyRecordsColumns,ref:"cutterBuyTable",queryBase:{companyName:t.editItemData.purchaseUnit},url:"/cutter-manage/buy/record/pages"},{operation:R((e=>[y(c,{type:"text",icon:"el-icon-delete",class:"color-danger",onClick:l=>t.handleDeleteBuyRecord(e.scopeData)},{default:R((()=>[A])),_:2},1032,["onClick"])])),_:1},8,["cols","queryBase"])])),_:1},8,["title","modelValue"]),y(V,{visible:t.addBuyVisible,onClose:l[14]||(l[14]=e=>t.addBuyVisible=!1),formItems:t.addBuyFormItems,propTitle:`${t.editBuyRecordItem?"编辑":"添加"}购买记录 - ${null==(i=t.editItemData)?void 0:i.purchaseUnit} - ${null==(u=t.editItemData)?void 0:u.name} - ${null==(d=t.editItemData)?void 0:d.specification}`,onDialogSubmit:t.addBuySubmit},null,8,["visible","formItems","propTitle","onDialogSubmit"])])}));_.render=E,_.__scopeId="data-v-0d98efb7";export default _;
