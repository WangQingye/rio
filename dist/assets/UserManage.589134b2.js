var e=Object.defineProperty,l=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,i=(l,a,t)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[a]=t;import{j as s,d,p as n,i as u,L as c,w as m,r as p,o as b,c as f,f as v,F as y,g as h,t as D,h as _,m as S}from"./vendor.b5aa390e.js";import{_ as C,i as I,j as k,k as O}from"./index.4d78699e.js";import{_ as j}from"./MesuringTable.6d60c92d.js";import{a as P}from"./ProductDetail.0fa2cf7a.js";const V={components:{BaseTable:j,ProductAdd:C,ProductDetail:P},name:"product-manage",setup(){const e=s({userName:"",roleId:""}),n=d([]),u=d(0),p=d(),b=()=>{p.value.refresh(e)},f=d(!1);let v=d(null);const y=d(!1),h=d(null),D=d(null);return I().then((e=>{h.value=e.data,D.value=[{label:"用户姓名",key:"realName",required:!0},{label:"用户角色",key:"role",required:!0,type:"select",options:e.data.map((e=>({label:e.roleName,value:e.id})))},{label:"手机号(登录账号)",key:"phone",required:!0,placeholder:""}]})),{roleList:h,columns:[{label:"用户姓名",prop:"realName"},{label:"手机号",prop:"phone"},{label:"用户角色",prop:"role",slot:"role"}],formItems:D,query:e,tableData:n,pageTotal:u,editVisible:f,handleSearch:b,handleDelete:e=>{c.confirm("确定要删除吗？","提示",{type:"warning"}).then((async()=>{await k({userId:e.id}),m.success("删除成功"),b()})).catch((()=>{}))},handleEdit:e=>{f.value=!0,v.value=e,v.value.role=e.roles[0].id},showDetail:e=>{v.value=e,y.value=!0},editItemData:v,editSubmit:async e=>{var s,d,n;await O((d=((e,l)=>{for(var a in l||(l={}))o.call(l,a)&&i(e,a,l[a]);if(t)for(var a of t(l))r.call(l,a)&&i(e,a,l[a]);return e})({id:null==(s=v.value)?void 0:s.id},e),n={password:e.phone},l(d,a(n)))),m.success("操作成功"),f.value=!1,b()},handleAdd:()=>{f.value=!0,v.value=null},detailVisible:y,userTable:p}}},g=_();n("data-v-0b35d1ed");const w={class:"container"},T=S("查询"),q=S("添加用户"),N=S("编辑 "),E=S("删除");u();const A=g(((e,l,a,t,o,r)=>{const i=p("el-input"),s=p("el-form-item"),d=p("el-option"),n=p("el-select"),u=p("el-button"),c=p("el-form"),m=p("BaseTable"),_=p("ProductAdd"),S=p("ProductDetail");return b(),f("div",null,[v("div",w,[v(c,{inline:!0,model:t.query,class:"demo-form-inline"},{default:g((()=>[v(s,{label:"用户姓名"},{default:g((()=>[v(i,{modelValue:t.query.userName,"onUpdate:modelValue":l[1]||(l[1]=e=>t.query.userName=e),placeholder:"用户姓名"},null,8,["modelValue"])])),_:1}),v(s,{label:"用户角色"},{default:g((()=>[v(n,{modelValue:t.query.roleId,"onUpdate:modelValue":l[2]||(l[2]=e=>t.query.roleId=e),placeholder:"用户角色",clearable:"",class:"handle-select mr10"},{default:g((()=>[(b(!0),f(y,null,h(t.roleList,(e=>(b(),f(d,{label:e.roleName,key:e.id,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),v(s,null,{default:g((()=>[v(u,{type:"primary",onClick:t.handleSearch},{default:g((()=>[T])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"]),v(u,{type:"primary",icon:"el-icon-plus",style:{"margin-bottom":"20px"},onClick:t.handleAdd},{default:g((()=>[q])),_:1},8,["onClick"]),v(m,{cols:t.columns,ref:"userTable",url:"/rui_ao/users"},{role:g((e=>[v("span",null,D({SYS_ADMIN:"系统管理员",SYS_EMPLOYEE:"普通员工",SYS_CONTACT:"外协联络员",SYS_PRODUCT:"生产管理员",SYS_STORE:"仓库管理员"}[e.scopeData.roles[0].roleCode]),1)])),operation:g((e=>[v(u,{type:"text",icon:"el-icon-edit",onClick:l=>t.handleEdit(e.scopeData)},{default:g((()=>[N])),_:2},1032,["onClick"]),v(u,{type:"text",icon:"el-icon-delete",class:"red",onClick:l=>t.handleDelete(e.scopeData)},{default:g((()=>[E])),_:2},1032,["onClick"])])),_:1},8,["cols"])]),v(_,{visible:t.editVisible,onClose:l[3]||(l[3]=e=>t.editVisible=!1),itemData:t.editItemData,formItems:t.formItems,onDialogSubmit:t.editSubmit},null,8,["visible","itemData","formItems","onDialogSubmit"]),v(S,{visible:t.detailVisible,onClose:l[4]||(l[4]=e=>t.detailVisible=!1),itemData:t.editItemData},null,8,["visible","itemData"])])}));V.render=A,V.__scopeId="data-v-0b35d1ed";export default V;
